<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AppQLNV_DL.Views.FullEmployeeListPage"
             xmlns:viewmodels="clr-namespace:AppQLNV_DL.ViewModels"
             Title="Danh báº¡ NhÃ¢n viÃªn"
             BackgroundColor="#F5F6FA">
    <!-- MÃ u ná»n xÃ¡m nháº¡t hiá»‡n Ä‘áº¡i -->

    <Grid RowDefinitions="Auto, *">

        <!-- 1. THANH TÃŒM KIáº¾M (SEARCH BAR) - Táº¡o cáº£m giÃ¡c á»©ng dá»¥ng Ä‘áº§y Ä‘á»§ tÃ­nh nÄƒng -->
        <Border Grid.Row="0" 
                Margin="15,10,15,5"
                StrokeShape="RoundRectangle 20"
                StrokeThickness="0"
                BackgroundColor="White"
                HeightRequest="45">
            <Border.Shadow>
                <Shadow Brush="Black" Offset="0,2" Radius="5" Opacity="0.05"/>
            </Border.Shadow>
            <Grid ColumnDefinitions="40, *">
                <Label Text="ðŸ”" VerticalOptions="Center" HorizontalOptions="Center" Margin="5,0,0,0"/>
                <Entry Grid.Column="1" 
                       Placeholder="TÃ¬m kiáº¿m tÃªn hoáº·c sá»‘ Ä‘iá»‡n thoáº¡i..." 
                       FontSize="14" 
                       VerticalOptions="Center" 
                       TextColor="#2D3436"/>
            </Grid>
        </Border>

        <RefreshView Grid.Row="1" 
                     IsRefreshing="{Binding IsRefreshing}"
                     Command="{Binding RefreshCommand}"
                     RefreshColor="RoyalBlue">

            <CollectionView ItemsSource="{Binding Employees}" 
                            SelectionMode="None"
                            Margin="10,5">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <!-- Tháº» Border thay cho Frame Ä‘á»ƒ cÃ³ bÃ³ng Ä‘á»• má»‹n hÆ¡n -->
                        <Border Margin="5,6" 
                                Padding="0" 
                                StrokeShape="RoundRectangle 12" 
                                StrokeThickness="0" 
                                BackgroundColor="White">
                            <Border.Shadow>
                                <Shadow Brush="Black" Offset="0,3" Radius="8" Opacity="0.08"/>
                            </Border.Shadow>

                            <!-- Nháº¥n vÃ o cáº£ tháº» Ä‘á»ƒ xem chi tiáº¿t (Giáº£ sá»­ báº¡n cÃ³ lá»‡nh nÃ y) -->
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:FullEmployeeListViewModel}}, Path=EmployeeSelectedCommand}"
                                                      CommandParameter="{Binding .}"/>
                            </Border.GestureRecognizers>

                            <Grid ColumnDefinitions="60, *, Auto" Padding="12" ColumnSpacing="10">

                                <!-- Cá»™t 0: áº¢nh Ä‘áº¡i diá»‡n giáº£ láº­p (Avatar) -->
                                <Border Grid.Column="0" 
                                        WidthRequest="50" 
                                        HeightRequest="50" 
                                        StrokeShape="RoundRectangle 25" 
                                        StrokeThickness="0" 
                                        BackgroundColor="#E3F2FD">
                                    <Label Text="ðŸ‘¤" 
                                           FontSize="22" 
                                           HorizontalOptions="Center" 
                                           VerticalOptions="Center"/>
                                </Border>

                                <!-- Cá»™t 1: ThÃ´ng tin nhÃ¢n viÃªn -->
                                <VerticalStackLayout Grid.Column="1" Spacing="2" VerticalOptions="Center">
                                    <Label Text="{Binding FullName}"
                                           FontAttributes="Bold"
                                           FontSize="16"
                                           TextColor="#2D3436"/>

                                    <HorizontalStackLayout Spacing="5" VerticalOptions="Center">
                                        <Label Text="ðŸ“ž" FontSize="12" Opacity="0.6" VerticalOptions="Center"/>
                                        <Label Text="{Binding PhoneNumber}"
                                               TextColor="#636E72"
                                               FontSize="13"
                                               VerticalOptions="Center"/>
                                    </HorizontalStackLayout>
                                </VerticalStackLayout>

                                <!-- Cá»™t 2: NÃºt hÃ nh Ä‘á»™ng -->
                                <HorizontalStackLayout Grid.Column="2" VerticalOptions="Center" Spacing="5">
                                    <Button Text="Gá»i"
                                            FontSize="12"
                                            FontAttributes="Bold"
                                            HeightRequest="34"
                                            Padding="15,0"
                                            TextColor="White"
                                            BackgroundColor="#27AE60" 
                                            CornerRadius="17"
                                            Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:FullEmployeeListViewModel}}, Path=CallEmployeeCommand}"
                                            CommandParameter="{Binding .}">
                                        <Button.Shadow>
                                            <Shadow Brush="#27AE60" Offset="0,2" Radius="4" Opacity="0.3"/>
                                        </Button.Shadow>
                                    </Button>

                                    <!-- MÅ©i tÃªn gá»£i Ã½ cÃ³ thá»ƒ nháº¥n vÃ o tháº» -->
                                    <Label Text="â¯" 
                                           TextColor="#BDC3C7" 
                                           FontSize="18" 
                                           VerticalOptions="Center" 
                                           Margin="5,0,0,0"/>
                                </HorizontalStackLayout>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </RefreshView>

        <!-- VÃ²ng xoay loading -->
        <ActivityIndicator Grid.Row="1"
                           IsRunning="{Binding IsBusy}"
                           IsVisible="{Binding IsBusy}"
                           VerticalOptions="Center"
                           HorizontalOptions="Center"
                           Color="RoyalBlue"
                           WidthRequest="50"
                           HeightRequest="50" />
    </Grid>
</ContentPage>